- builder:
    name: transform-spec-file
    builders:
      - shell: |
          #!/bin/bash -e
          # Ensure we do not expose secrets
          set +x
          set -o pipefail
          release="pr${{ghprbPullId?No pull id}}job${{BUILD_NUMBER?No build number}}"
          sed "s/^Release:.*/Release: ${{release}}/" -i {specfile}
          sed "/Release: ${{release}}/aProvides: {name}-git-commit(${{ghprbActualCommit?No commit}})" -i {specfile}
          sed "/Release: ${{release}}/aProvides: {name}-pull-request(${{ghprbPullId?No pull id}})" -i {specfile}
          sed "/Release: ${{release}}/aProvides: {name}-pull-request-build-id(pr${{ghprbPullId?No pull id}}job${{BUILD_NUMBER?No build number}})" -i {specfile}
          sed "/Release: ${{release}}/aEpoch: ${{BUILD_NUMBER?No build number}}" -i {specfile}
          cat {specfile}
          grep {name}-git-commit {specfile}
          grep {name}-pull-request {specfile}
          grep {name}-pull-request-build-id {specfile}

