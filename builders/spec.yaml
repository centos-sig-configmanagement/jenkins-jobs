- builder:
    name: transform-spec-file
    builders:
      - shell: |
          #!/bin/bash -e
          # Ensure we do not expose secrets
          set +x
          set -o pipefail
          sed "s/^Release:.*/Release: pr${{ghprbPullId?No pull id}}job${{BUILD_NUMBER?No build number}}/" -i {specfile}
          sed "/Release: ${{ghprbActualCommit?No commit}}/aProvides: {name}-git-commit(${{ghprbActualCommit?No commit}})" -i {specfile}
          sed "/Release: ${{ghprbActualCommit?No commit}}/aProvides: {name}-pull-request(${{ghprbPullId?No pull id}})" -i {specfile}
          sed "/Release: ${{ghprbActualCommit?No commit}}/aEpoch: ${{BUILD_NUMBER?No build number}}" -i {specfile}
          cat {specfile}

