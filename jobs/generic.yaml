- job-template:
    name: 'sig-configmanagement-{repo}-{version}-{buildtype}'
    display-name: 'Config Management SIG / {displayname}'
    node: sig-configmanagement
    logrotate:
      numToKeep: 15
    parameters: '{obj:parameters}'
    properties:
      - github:
          url: https://github.com/centos-sig-configmanagement/{repo}
    scm: '{obj:scm}'
    triggers: '{obj:triggers}'
    publishers:
      - '{repo}-{buildtype}': '{obj:publisherparameters}'
    builders:
      - '{repo}-{buildtype}': '{obj:builderparameters}'

- job-group:
      name: sig-job-{repository}
      jobs:
        - sig-configmanagement-{repo}-{version}-{buildtype}:
            repo: '{repository}'
            parameters:
              - string:
                  name: sha1
                  default: '{branch}'
            buildtype: branch
            displayname: '{prettyname}'
            builderparameters: '{obj:builderparameters}'
            triggers:
              - github:
            scm:
              - git:
                  refspec: +refs/heads/*:refs/remotes/origin/*
                  url: https://github.com/centos-sig-configmanagement/{repository}
                  branches:
                    - '{branch}'
          # - github-notifier is broken
        - sig-configmanagement-{repo}-{version}-{buildtype}:
            repo: '{repository}'
            parameters: []
            buildtype: pullrequest
            builderparameters: '{obj:builderparameters}'
            displayname: '{prettyname} (Pull Requests)'
            triggers:
              - githubprb:
                  admins:
                    - roidelapluie
                    - hguemar
                    - fcami
            prpublishers: []
            scm:
              - git:
                  refspec: +refs/pull/*:refs/remotes/origin/pr/*
                  url: https://github.com/centos-sig-configmanagement/{repository}
                  branches:
                    - '${{sha1}}'
